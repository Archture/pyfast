#!/usr/bin/env python

from sys import argv
from pyfast import Cukier
from getopt import getopt

DEFAULT_OMEGA_LISTFILE = "cukier_frequency.csv"
DEFAULT_DELTA_OMEGA_LISTFILE = "cukier_frequency_offset.csv"


def print_usage():
    print("Usage: generate_samples [-h] [--delta_omega FILE]"
          " [--omega FILE] <output file name>")
    print("Options:")
    print("-h, --help\t\tUsage instructions")
    print("    --delta_omega FILE\tFile containing frequency offsets."
          " (Default: {0})".format(DEFAULT_DELTA_OMEGA_LISTFILE))
    print("    --omega FILE\tFile initial containing frequencies"
          " (Default: {0})".format(DEFAULT_OMEGA_LISTFILE))

(opts, args) = getopt(argv[1:], "h", ["help", "delta_omega=", "omega="])

omega_listfile = DEFAULT_OMEGA_LISTFILE 
delta_omega_file = DEFAULT_DELTA_OMEGA_LISTFILE 
for (opt, optarg) in opts:
    while opt[0] == '-':
        opt = opt[1:]

    if opt in ["h", "help"]:
        print_usage()
        exit(0)
    elif opt == "delta_omega":
        delta_omega_file = optarg
    elif opt == "omega":
        omega_listfile = optarg

if len(args) != 1:
    from sys import stderr
    stderr.write("Missing number of parameters\n")
    stderr.write("For help, run generate_frequencies -h\n")
    exit(1)

num_params = int(args[0])

# Load data
omega_0_list = open(omega_listfile, "r").read().split(",")
delta_omega_0_list = [int(i) for i in open(delta_omega_file, "r")
                      .read().split(",")]

# Ensure omega 0 list is made of ints
for i in xrange(0, len(omega_0_list)):
    if not omega_0_list[i].isdigit():
        omega_0_list[i] = 0
    omega_0_list[i] = int(omega_0_list[i])

# Generate List
cukier = Cukier(omega_0_list, delta_omega_0_list)
stuff = cukier.freq(int(num_params))
print(",".join([str(i) for i in stuff]))
